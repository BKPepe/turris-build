From 7bb5f5da31afe40b4f24742de51aee096f9733a1 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Marek=20Beh=C3=BAn?= <marek.behun@nic.cz>
Date: Thu, 30 Apr 2020 17:44:54 +0200
Subject: [PATCH] target: generic: don't depend on libyaml for kernel 5.4's dtc
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Marek Behún <marek.behun@nic.cz>
---
 .../hack-5.4/999-dtc-don-t-use-libyaml.patch  | 29 +++++++++++++++++++
 1 file changed, 29 insertions(+)
 create mode 100644 target/linux/generic/hack-5.4/999-dtc-don-t-use-libyaml.patch

diff --git a/target/linux/generic/hack-5.4/999-dtc-don-t-use-libyaml.patch b/target/linux/generic/hack-5.4/999-dtc-don-t-use-libyaml.patch
new file mode 100644
index 0000000..d614068
--- /dev/null
+++ b/target/linux/generic/hack-5.4/999-dtc-don-t-use-libyaml.patch
@@ -0,0 +1,29 @@
+From 3cf15219974d52a41e682ca78256327e77a46b48 Mon Sep 17 00:00:00 2001
+From: =?UTF-8?q?Marek=20Beh=C3=BAn?= <marek.behun@nic.cz>
+Date: Thu, 30 Apr 2020 17:43:18 +0200
+Subject: [PATCH] dtc: don't use libyaml
+MIME-Version: 1.0
+Content-Type: text/plain; charset=UTF-8
+Content-Transfer-Encoding: 8bit
+
+Signed-off-by: Marek Behún <marek.behun@nic.cz>
+---
+ scripts/dtc/Makefile | 2 +-
+ 1 file changed, 1 insertion(+), 1 deletion(-)
+
+diff --git a/scripts/dtc/Makefile b/scripts/dtc/Makefile
+index b5a5b1c548c9..0a69ded24fa5 100644
+--- a/scripts/dtc/Makefile
++++ b/scripts/dtc/Makefile
+@@ -11,7 +11,7 @@ dtc-objs	+= dtc-lexer.lex.o dtc-parser.tab.o
+ # Source files need to get at the userspace version of libfdt_env.h to compile
+ HOST_EXTRACFLAGS := -I $(srctree)/$(src)/libfdt
+ 
+-ifeq ($(shell pkg-config --exists yaml-0.1 2>/dev/null && echo yes),)
++ifeq (1,1)
+ ifneq ($(CHECK_DTBS),)
+ $(error dtc needs libyaml for DT schema validation support. \
+ 	Install the necessary libyaml development package.)
+-- 
+2.24.1
+
-- 
2.24.1

