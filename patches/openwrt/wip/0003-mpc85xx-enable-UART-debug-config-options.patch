From b4c1545ab48f66b1d16403ad56850361bfca35ba Mon Sep 17 00:00:00 2001
From: Josef Schlehofer <pepe.schlehofer@gmail.com>
Date: Wed, 4 May 2022 17:26:47 +0200
Subject: [PATCH] mpc85xx: enable UART debug config options

---
 target/linux/mpc85xx/config-5.4 | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/target/linux/mpc85xx/config-5.4 b/target/linux/mpc85xx/config-5.4
index 0c177d5e8f..4a3975a412 100644
--- a/target/linux/mpc85xx/config-5.4
+++ b/target/linux/mpc85xx/config-5.4
@@ -36,8 +36,9 @@ CONFIG_BUILD_BIN2C=y
 # CONFIG_C293_PCIE is not set
 CONFIG_CLONE_BACKWARDS=y
 CONFIG_CLZ_TAB=y
-CONFIG_CMDLINE="console=ttyS0,115200"
+CONFIG_CMDLINE="earlycon=ns16550,0xffe04500 console=ttyS0,115200"
 CONFIG_CMDLINE_BOOL=y
+CONFIG_CMDLINE_FROM_BOOTLOADER=y
 # CONFIG_CMDLINE_OVERRIDE is not set
 CONFIG_COMPAT_32BIT_TIME=y
 # CONFIG_CORENET_GENERIC is not set
@@ -265,8 +266,10 @@ CONFIG_RTC_I2C_AND_SPI=y
 CONFIG_RTC_MC146818_LIB=y
 # CONFIG_SBC8548 is not set
 # CONFIG_SCOM_DEBUGFS is not set
+CONFIG_SERIAL_EARLYCON=y
 CONFIG_SERIAL_8250_EXTENDED=y
 CONFIG_SERIAL_8250_FSL=y
+CONFIG_SERIAL_8250_CONSOLE=y
 CONFIG_SERIAL_8250_SHARE_IRQ=y
 CONFIG_SERIAL_MCTRL_GPIO=y
 CONFIG_SERIAL_OF_PLATFORM=y
-- 
2.34.1

