From 02789309edfef3309658532e73e0119528bece4f Mon Sep 17 00:00:00 2001
From: Michal Vasilek <michal.vasilek@nic.cz>
Date: Fri, 1 Oct 2021 17:44:38 +0200
Subject: [PATCH] mvebu, mpc85xx: enable BFQ

BFQ is an IO scheduler which enables higher IO throughput on hard drives
on sequential workloads which is especially nice for NASes.

It also BFQ hierarchical scheduling support [2]

[2] https://cateee.net/lkddb/web-lkddb/BFQ_GROUP_IOSCHED.html

Signed-off-by: Michal Vasilek <michal.vasilek@nic.cz>
---
 target/linux/mpc85xx/config-5.15 | 2 ++
 target/linux/mvebu/config-5.15   | 2 ++
 2 files changed, 2 insertions(+)

diff --git a/target/linux/mpc85xx/config-5.15 b/target/linux/mpc85xx/config-5.15
index d19df1ba90..44b932dac1 100644
--- a/target/linux/mpc85xx/config-5.15
+++ b/target/linux/mpc85xx/config-5.15
@@ -93,6 +93,8 @@ CONFIG_HAS_IOPORT_MAP=y
 CONFIG_HZ_PERIODIC=y
 CONFIG_ILLEGAL_POINTER_VALUE=0
 CONFIG_INITRAMFS_SOURCE=""
+CONFIG_IOSCHED_BFQ=y
+CONFIG_BFQ_GROUP_IOSCHED=y
 CONFIG_IRQCHIP=y
 CONFIG_IRQ_DOMAIN=y
 CONFIG_IRQ_FORCED_THREADING=y
diff --git a/target/linux/mvebu/config-5.15 b/target/linux/mvebu/config-5.15
index 1c70d1d4ad..13b36523b4 100644
--- a/target/linux/mvebu/config-5.15
+++ b/target/linux/mvebu/config-5.15
@@ -72,6 +72,8 @@ CONFIG_HAS_IOPORT_MAP=y
 CONFIG_HZ_FIXED=0
 CONFIG_HZ_PERIODIC=y
 CONFIG_INITRAMFS_SOURCE=""
+CONFIG_IOSCHED_BFQ=y
+CONFIG_BFQ_GROUP_IOSCHED=y
 CONFIG_IRQCHIP=y
 CONFIG_IRQ_DOMAIN=y
 CONFIG_IRQ_FORCED_THREADING=y
