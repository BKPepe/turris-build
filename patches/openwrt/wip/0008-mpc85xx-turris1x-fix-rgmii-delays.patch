From 73b811092b805df44105a292a645518c58d19207 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Marek=20Beh=C3=BAn?= <marek.behun@nic.cz>
Date: Thu, 5 Sep 2019 14:24:13 +0200
Subject: [PATCH] mpc85xx: turris1x: fix rgmii delays
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Add patches that fix rgmii delays for qca8k DSA driver.

Signed-off-by: Marek Beh√∫n <marek.behun@nic.cz>
---
 .../401-net-dsa-qca8k-fix-turris-1x.patch          | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 target/linux/mpc85xx/patches-5.4/401-net-dsa-qca8k-fix-turris-1x.patch

diff --git a/target/linux/mpc85xx/patches-5.4/401-net-dsa-qca8k-fix-turris-1x.patch b/target/linux/mpc85xx/patches-5.4/401-net-dsa-qca8k-fix-turris-1x.patch
new file mode 100644
index 0000000000..0ec9a7fd71
--- /dev/null
+++ b/target/linux/mpc85xx/patches-5.4/401-net-dsa-qca8k-fix-turris-1x.patch
@@ -0,0 +1,14 @@
+diff -Naurp a/drivers/net/dsa/qca8k.c b/drivers/net/dsa/qca8k.c
+--- a/drivers/net/dsa/qca8k.c	2021-12-01 09:23:36.000000000 +0100
++++ b/drivers/net/dsa/qca8k.c	2021-12-21 00:32:23.777571556 +0100
+@@ -451,8 +451,8 @@ qca8k_set_pad_ctrl(struct qca8k_priv *pr
+ 		 */
+ 		qca8k_write(priv, reg,
+ 			    QCA8K_PORT_PAD_RGMII_EN |
+-			    QCA8K_PORT_PAD_RGMII_TX_DELAY(QCA8K_MAX_DELAY) |
+-			    QCA8K_PORT_PAD_RGMII_RX_DELAY(QCA8K_MAX_DELAY));
++			    QCA8K_PORT_PAD_RGMII_TX_DELAY(1) |
++			    QCA8K_PORT_PAD_RGMII_RX_DELAY(2));
+ 		qca8k_write(priv, QCA8K_REG_PORT5_PAD_CTRL,
+ 			    QCA8K_PORT_PAD_RGMII_RX_DELAY_EN);
+ 		break;
-- 
2.32.0

