From d9d7fbd531e144e93f1d174e2ba6e09464b6202f Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Karel=20Ko=C4=8D=C3=AD?= <karel.koci@nic.cz>
Date: Wed, 20 Feb 2019 12:51:05 +0100
Subject: [PATCH] python,python3: do not package binary files to base packages
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Thanks to fix 200a5a2eec896b2d34f1114d14df66d810c1f4bd all base packages
now contain all binaries that are generated as part of python
installation. That causes collision between those packages with package
managers that consider this such as Turris updater-ng. This is also just
wrong. Those binaries were not included and should not be after
mentioned fix as well.

This just adds empty install definition. The idea is to override the
default one that is otherwise used.

Signed-off-by: Karel Kočí <karel.koci@nic.cz>
---
 lang/python/python/Makefile  | 4 ++++
 lang/python/python3/Makefile | 4 ++++
 2 files changed, 8 insertions(+)

diff --git a/lang/python/python/Makefile b/lang/python/python/Makefile
index 041b3028c..96f18ecac 100644
--- a/lang/python/python/Makefile
+++ b/lang/python/python/Makefile
@@ -106,6 +106,7 @@ define PyBasePackage
       -|/usr/lib/python$(PYTHON_VERSION)/*/tests
     endif
   endef
+  PyPackage/$(1)/install?=:
 endef
 
 include ./files/python-package-*.mk
@@ -263,6 +264,9 @@ define PyPackage/python-base/install
 	$(CP) $(PKG_INSTALL_DIR)/usr/lib/libpython$(PYTHON_VERSION).so* $(1)/usr/lib/
 endef
 
+PyPackage/python-light/install?=:
+PyPackage/python/install?=:
+
 define PyPackage/python/filespec
 -|$(PYTHON_PKG_DIR)
 endef
diff --git a/lang/python/python3/Makefile b/lang/python/python3/Makefile
index a88b8165c..bdaa9aec5 100644
--- a/lang/python/python3/Makefile
+++ b/lang/python/python3/Makefile
@@ -110,6 +110,7 @@ define Py3BasePackage
       -|/usr/lib/python$(PYTHON_VERSION)/*/tests
     endif
   endef
+  Py3Package/$(1)/install?=:
 endef
 
 include ./files/python3-package-*.mk
@@ -264,6 +265,9 @@ define Py3Package/python3-base/install
 	$(CP) $(PKG_INSTALL_DIR)/usr/lib/libpython$(PYTHON_VERSION).so* $(1)/usr/lib/
 endef
 
+Py3Package/python3-light/install?=:
+Py3Package/python3/install?=:
+
 define Py3Package/python3/filespec
 -|$(PYTHON3_PKG_DIR)
 endef
-- 
2.20.1

