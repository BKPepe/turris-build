From 02bc98a0c3bcfd56c0c26525b86827f2953c76fd Mon Sep 17 00:00:00 2001
From: Josef Schlehofer <pepe.schlehofer@gmail.com>
Date: Fri, 1 Jan 2021 14:34:10 +0100
Subject: [PATCH] test

If there is no /usr/sbin/ntpd, the ntpd section in LuCI isn't shown.
This happens when we have located busybox ntpd in /sbin/ntpd instead of
/usr/sbin/ntpd.

Related to: https://gitlab.labs.nic.cz/turris/turris-build/blob/master/patches/openwrt/hack/0003-busybox-Try-to-install-everything-into-s-bin.patch

Fixes: https://forum.turris.cz/t/ntp-server-choice-removed/10405/14?u=pepe

---
 .../root/usr/share/rpcd/acl.d/luci-mod-network.json              | 1 +
 1 file changed, 1 insertion(+)

diff --git a/modules/luci-mod-network/root/usr/share/rpcd/acl.d/luci-mod-network.json b/modules/luci-mod-network/root/usr/share/rpcd/acl.d/luci-mod-network.json
index d6c84bab2..4eea3b30b 100644
--- a/modules/luci-mod-network/root/usr/share/rpcd/acl.d/luci-mod-network.json
+++ b/modules/luci-mod-network/root/usr/share/rpcd/acl.d/luci-mod-network.json
@@ -46,6 +46,7 @@
 		"description": "Grant access to network diagnostic tools",
 		"read": {
 			"file": {
+				"/bin/nslookup": [ "exec" ],
 				"/bin/ping": [ "exec" ],
 				"/bin/ping6": [ "exec", "list" ],
 				"/bin/traceroute": [ "exec" ],
--
2.25.1
